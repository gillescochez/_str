/*! _str (c) G.Cochez 2011 - MIT/GPL -github.com/gillescochez/_str */
(function(){var g=Array.prototype.slice,h=function(j){return new h.init(j)};h.init=function(j){this.historyIndex=0;this.history=[];this.data={};this[0]=j||"";return this};h.fn=h.init.prototype;e(h.fn,{manip:function(){this.history[this.historyIndex]=this[0];this.historyIndex++;this[0]=this["_"+arguments[0]].apply(this,g.call(arguments,1));return this},back:function(){var j=this.history.length-1;if(j<0){j=0}this[0]=this.history[j];delete this.history[j];return this},set:function(j,k){if(!k){this.data[j]=this[0]}else{this.data[j]=k}return this},get:function(j){if(!j){return this.data}else{return this.data[j]||null}},getHistory:function(){return this.history},indexOf:function(j){return this[0].indexOf(j)},lastIndexOf:function(j){return this[0].lastIndexOf(j)},write:function(){document.write(this[0])},size:function(){return this[0].length},end:function(){return this[0]}});function e(l,k){var j,m,n;for(j in k){m=l[j];n=k[j];if(l===n){continue}if(n!==undefined){l[j]=n}}return l}function f(m,l){var j,k;if(a(m)){m=m.split(" ")}j=m.length;if(d(m)){for(k=0;k<j;k++){l(k,m[k])}}else{for(k in m){l(k,m[k])}}}function a(j){return typeof j==="string"}function i(j){return typeof j==="object"}function c(j){return typeof j==="boolean"}function d(j){if(i(j)){return j.constructor==Array}else{return false}}e(h.fn,{_eq:function(j){return this[0].substr(j,1)},_sub:function(k,j){return this[0].substr(k,j)},_subReplace:function(j,l,k){if(l<0){l=l+this[0].length}k=k!==undefined?k:this[0].length;if(k<0){k=k+this[0].length-l}return this[0].slice(0,l)+j.substr(0,k)+j.slice(k)+this[0].slice(l+k)},subCount:function(l,m,k){var n=0,j=0;if(isNaN(m)){m=0}if(isNaN(k)){k=0}m--;while((m=this[0].indexOf(l,m+1))!=-1){if(k>0&&(m+l.length)>k){return false}else{j++}}return j},subCompare:function(n,m,l,k){var j=this[0];if(!m&&m!==0){throw"Missing offset for substr_compare()"}if(m<0){m=j.length+m}if(l&&l>(j.length-m)){return false}l=l||j.length-m;j=j.substr(m,l);n=n.substr(0,l);if(k){j=(j+"").toLowerCase();n=(n+"").toLowerCase();if(j==n){return 0}return(j>n)?1:-1}return((j==n)?0:((j>n)?1:-1))},_low:function(){return this[0].toLowerCase()},_lowFirst:function(){return this[0].charAt(0).toLowerCase()+this[0].substr(1)},_lowFirstAll:function(){return this[0].replace(/^([A-Z])|\s+([A-Z])/g,function(j){return j.toLowerCase()})},_up:function(){return this[0].toUpperCase()},_upFirst:function(){return this[0].charAt(0).toUpperCase()+this[0].substr(1)},_upFirstAll:function(){return this[0].replace(/^([a-z])|\s+([a-z])/g,function(j){return j.toUpperCase()})},_rtrim:function(){return this[0].replace(/[ \\s\u00A0]+$/g,"")},_ltrim:function(){return this[0].replace(/^[ \\s\u00A0]+/g,"")},_trim:function(){return this[0].replace(/^\s+|\s+$/g,"")},_reverse:function(){return this[0].split("").reverse().join("")},_replace:function(o,p,m){var k,n,j,l;if(c(p)){m=p}if(a(o)&&a(p)){if(m){o=new RegExp(o,"gi")}return this[0].replace(o,p)}if(d(o)&&d(p)){for(l=0,j=o.length;l<j;l++){this[0]=this._replace(o[l],p[l],m)}}if(i(o)&&!i(p)){for(k in o){if(m){n=new RegExp(k,"gi")}else{n=k}this[0]=this[0].replace(n,o[k])}}return this[0]},_replaceAll:function(){var j=g.call(arguments);j.push(true);return this._replace.apply(this,j)},_remove:function(n,m){var k=[],j,l;if(d(n)){j=n.length;for(l=0;l<j;l++){k[l]=""}return this._replace(n,k,m)}return this._replace(n,"",m)},_removeAll:function(j){return this._remove(j,true)},_wordwrap:function(n,y,w){var o=n||75,v=y||"\n",u=w||false,t,q,p,x,k;str=this[0];if(o<1){return str}for(t=-1,p=(k=str.split(/\r\n|\n|\r/)).length;++t<p;k[t]+=x){for(x=k[t],k[t]="";x.length>o;k[t]+=x.slice(0,q)+((x=x.slice(q)).length?v:"")){q=u==2||(q=x.slice(0,o+1).match(/\S*(\s)?$/))[1]?o:q.input.length-q[0].length||u==1&&o||q.input.length+(q=x.slice(o).match(/^\S*/)).input.length}}return k.join("\n")},_append:function(j){return this[0]+j},_prepend:function(j){return j+this[0]}});e(h.fn,{_nl2br:function(){return this[0].replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />")},_stripTags:function(l){l=(((l||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var j=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,k=/<!--[\s\S]*?-->/gi;return this[0].replace(k,"").replace(j,function(n,m){return l.indexOf("<"+m.toLowerCase()+">")>-1?n:""})},_stripSlashes:function(){return this[0].replace(/\\(.?)/g,function(k,j){switch(j){case"\\":return"\\";case"0":return"\u0000";case"":return"";default:return j}})},_urls:function(){return this[0].replace(/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi,function(k,j){return'<a href="'+k+'">'+k+"</a>"})},_emails:function(){return this[0].replace(/(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/gi,function(k,j){return'<a href="mailto:'+k+'">'+k+"</a>"})},_encodeEntities:function(j){var l=b("HTML_ENTITIES",j),k="";if(!l){return false}if(j&&j==="ENT_QUOTES"){l["'"]="&#039;"}return this[0].replace(/([\s\S]*?)(&(?:#\d+|#x[\da-f]+|[a-zA-Z][\da-z]*);|$)/g,function(o,n,m){for(k in l){if(l.hasOwnProperty(k)){n=n.split(k).join(l[k])}}return n+m})},_decodeEntities:function(k){var m={},l="",j="";if(false===(m=b("HTML_ENTITIES",k))){return false}delete m["&"];m["&"]="&amp;";for(l in m){j=m[l];this[0]=this[0].split(j).join(l)}this[0]=this[0].split("&#039;").join("'");return this[0]},_encodeSpecial:function(l,k){var n=0,m=0,o=false;if(typeof l==="undefined"||l===null){l=2}string=this[0];if(k!==false){string=string.replace(/&/g,"&amp;")}string=string.replace(/</g,"&lt;").replace(/>/g,"&gt;");var j={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(l===0){o=true}if(typeof l!=="number"){l=[].concat(l);for(m=0;m<l.length;m++){if(j[l[m]]===0){o=true}else{if(j[l[m]]){n=n|j[l[m]]}}}l=n}if(l&j.ENT_HTML_QUOTE_SINGLE){string=string.replace(/'/g,"&#039;")}if(!o){string=string.replace(/"/g,"&quot;")}return string},_decodeSpecial:function(k){var m=1,l=0,n=false;string=this[0];if(typeof k==="undefined"){quote_style=2}string=string.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var j={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(k===0){n=true}if(typeof k!=="number"){k=[].concat(quote_style);for(l=0;l<k.length;l++){if(j[k[l]]===0){n=true}else{if(j[k[l]]){m=m|j[quote_style[l]]}}}k=m}if(k&j.ENT_HTML_QUOTE_SINGLE){string=string.replace(/&#0*39;/g,"'")}if(!n){string=string.replace(/&quot;/g,'"')}string=string.replace(/&amp;/g,"&");return string}});function b(q,j){var n={},k={},m,o={},l={},r={},p={};o[0]="HTML_SPECIALCHARS";o[1]="HTML_ENTITIES";l[0]="ENT_NOQUOTES";l[2]="ENT_COMPAT";l[3]="ENT_QUOTES";r=!isNaN(q)?o[q]:q?q.toUpperCase():"HTML_SPECIALCHARS";p=!isNaN(j)?l[j]:j?j.toUpperCase():"ENT_COMPAT";if(r!=="HTML_SPECIALCHARS"&&r!=="HTML_ENTITIES"){throw new Error("Table: "+r+" not supported")}n["38"]="&amp;";if(r==="HTML_ENTITIES"){n["160"]="&nbsp;";n["161"]="&iexcl;";n["162"]="&cent;";n["163"]="&pound;";n["164"]="&curren;";n["165"]="&yen;";n["166"]="&brvbar;";n["167"]="&sect;";n["168"]="&uml;";n["169"]="&copy;";n["170"]="&ordf;";n["171"]="&laquo;";n["172"]="&not;";n["173"]="&shy;";n["174"]="&reg;";n["175"]="&macr;";n["176"]="&deg;";n["177"]="&plusmn;";n["178"]="&sup2;";n["179"]="&sup3;";n["180"]="&acute;";n["181"]="&micro;";n["182"]="&para;";n["183"]="&middot;";n["184"]="&cedil;";n["185"]="&sup1;";n["186"]="&ordm;";n["187"]="&raquo;";n["188"]="&frac14;";n["189"]="&frac12;";n["190"]="&frac34;";n["191"]="&iquest;";n["192"]="&Agrave;";n["193"]="&Aacute;";n["194"]="&Acirc;";n["195"]="&Atilde;";n["196"]="&Auml;";n["197"]="&Aring;";n["198"]="&AElig;";n["199"]="&Ccedil;";n["200"]="&Egrave;";n["201"]="&Eacute;";n["202"]="&Ecirc;";n["203"]="&Euml;";n["204"]="&Igrave;";n["205"]="&Iacute;";n["206"]="&Icirc;";n["207"]="&Iuml;";n["208"]="&ETH;";n["209"]="&Ntilde;";n["210"]="&Ograve;";n["211"]="&Oacute;";n["212"]="&Ocirc;";n["213"]="&Otilde;";n["214"]="&Ouml;";n["215"]="&times;";n["216"]="&Oslash;";n["217"]="&Ugrave;";n["218"]="&Uacute;";n["219"]="&Ucirc;";n["220"]="&Uuml;";n["221"]="&Yacute;";n["222"]="&THORN;";n["223"]="&szlig;";n["224"]="&agrave;";n["225"]="&aacute;";n["226"]="&acirc;";n["227"]="&atilde;";n["228"]="&auml;";n["229"]="&aring;";n["230"]="&aelig;";n["231"]="&ccedil;";n["232"]="&egrave;";n["233"]="&eacute;";n["234"]="&ecirc;";n["235"]="&euml;";n["236"]="&igrave;";n["237"]="&iacute;";n["238"]="&icirc;";n["239"]="&iuml;";n["240"]="&eth;";n["241"]="&ntilde;";n["242"]="&ograve;";n["243"]="&oacute;";n["244"]="&ocirc;";n["245"]="&otilde;";n["246"]="&ouml;";n["247"]="&divide;";n["248"]="&oslash;";n["249"]="&ugrave;";n["250"]="&uacute;";n["251"]="&ucirc;";n["252"]="&uuml;";n["253"]="&yacute;";n["254"]="&thorn;";n["255"]="&yuml;"}if(p!=="ENT_NOQUOTES"){n["34"]="&quot;"}if(p==="ENT_QUOTES"){n["39"]="&#39;"}n["60"]="&lt;";n["62"]="&gt;";for(m in n){if(n.hasOwnProperty(m)){k[String.fromCharCode(m)]=n[m]}}return k}f(h.fn,function(k){var j=k.substr(0,1)==="_",l=k.substr(1,k.length-1);if(j){h.fn[l]=function(){var m=g.call(arguments);m.unshift(l);return this.manip.apply(this,m)}}});window._str=h})();